{% extends 'base.html' %}

{% block title %}Nova Receita{% endblock %}

{% block content %}
  <h1>Criar nova receita</h1>
  <form method="post">
    <div class="mb-3">
      <label class="form-label">Nome</label>
      <input class="form-control" type="text" name="nome" required>
    </div>
    <div class="mb-3">
      <label class="form-label">Dificuldade</label>
      <input class="form-control" type="text" name="dificuldade">
    </div>
    <div class="mb-3 row">
      <div class="col">
        <label class="form-label">Tempo (min)</label>
        <input class="form-control" type="number" name="tempo_preparacao">
      </div>
      <div class="col">
        <label class="form-label">Categoria</label>
        <input class="form-control" type="text" name="categoria">
      </div>
    </div>
    <div class="mb-3">
      <label class="form-label">Nº pessoas</label>
      <input class="form-control" type="number" name="numero_de_pessoas">
    </div>
    <div class="mb-3">
      <label class="form-label">Preparação</label>
      <textarea class="form-control" name="preparacao"></textarea>
    </div>
    <div class="mb-3">
      <label class="form-label">Ingredientes</label>
      <table class="table" id="ingredientes-table">
        <thead>
          <tr><th>Nome</th><th>Quantidade</th><th>Unidade</th><th></th></tr>
        </thead>
        <tbody></tbody>
      </table>
      <button type="button" class="btn btn-sm btn-outline-secondary" id="add-ingrediente">Adicionar ingrediente</button>
    </div>
    <button class="btn btn-primary" type="submit">Criar</button>
    <a class="btn btn-secondary ms-2" href="/">Voltar</a>
  </form>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
  function addRow(nome='', quantidade='', unidade=''){
    const tbody = document.querySelector('#ingredientes-table tbody');
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><input class="form-control" name="ing_nome" value="${nome}"></td>
      <td><input class="form-control" name="ing_quantidade" value="${quantidade}"></td>
      <td><input class="form-control" name="ing_unidade" value="${unidade}"></td>
      <td><button type="button" class="btn btn-sm btn-danger remove-row">Remover</button></td>
    `;
    tbody.appendChild(tr);
    tr.querySelector('.remove-row').addEventListener('click', ()=> tr.remove());
  }
  document.getElementById('add-ingrediente').addEventListener('click', ()=> addRow());
  // adicionar uma linha inicial
  addRow();
  </script>
{% endblock %}